---
- hosts: localhost
  connection: local
  vars:
    date_latest_bootstrap: "{{ lookup('pipe', 'date +%Y.%m.01') }}"
    base_url: https://archive.archlinux.org/iso/{{ date_latest_bootstrap }}
    files:
      tarball: archlinux-bootstrap-{{ date_latest_bootstrap }}-x86_64.tar.gz
      checksum: sha1sums.txt
  tasks:
    - name: Create a container based on Arch Linux
      block:
        - name: Download Arch Linux bootstrap tarball
          get_url:
            url: "{{ base_url }}/{{ files.tarball }}"
            dest: .
            checksum: sha1:{{ base_url }}/{{ files.checksum }}
